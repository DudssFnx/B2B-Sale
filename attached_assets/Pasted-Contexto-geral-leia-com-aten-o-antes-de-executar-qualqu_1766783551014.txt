Contexto geral (leia com atenÃ§Ã£o antes de executar qualquer mudanÃ§a):
Este projeto Ã© um SaaS multi-tenant B2B.
Ele nÃ£o pode depender do ambiente do Replit para funcionar.
Tudo precisa rodar de forma idÃªntica em:

ambiente local

Railway (Postgres)

Vercel (deploy final)

Nenhuma mudanÃ§a deve quebrar funcionalidades existentes.

ğŸ¯ OBJETIVO PRINCIPAL

Finalizar a arquitetura multi-tenant e deixar o projeto 100% pronto para produÃ§Ã£o, com:

isolamento total de dados por empresa (company_id)

lojas pÃºblicas por slug (/loja/:slug)

painel administrativo com contexto de empresa

painel SUPER_ADMIN global

zero dependÃªncia do Replit

ğŸ§© TAREFA 1 â€” ISOLAMENTO TOTAL POR company_id (CRÃTICO)
O que precisa ser garantido:

Todas as tabelas de negÃ³cio devem possuir company_id:

products / b2b_products

categories

orders / b2b_orders

order_items

banners / catalog_banners / catalog_slides

coupons

price_tables

site_settings / catalog_config

qualquer outra tabela que represente dados da loja

Nenhuma query pode:

buscar

criar

atualizar

deletar
dados sem filtrar por company_id.

Constraints:

Ã­ndices UNIQUE devem ser (company_id + campo) quando aplicÃ¡vel

nunca mais UNIQUE global para dados de loja

O backend deve exigir companyId explicitamente em:

criaÃ§Ã£o de produtos

criaÃ§Ã£o de categorias

criaÃ§Ã£o de pedidos

criaÃ§Ã£o de banners

ğŸ§© TAREFA 2 â€” CONTEXTO activeCompanyId NO PAINEL
Implementar:

Resolver activeCompanyId apÃ³s login:

via relaÃ§Ã£o user_companies

ou empresa padrÃ£o do usuÃ¡rio

Criar um CompanyContext no frontend:

expÃµe companyId, companyName, companySlug

usado automaticamente em chamadas privadas

Backend:

APIs privadas NUNCA recebem slug

sempre usam companyId vindo do contexto autenticado

ğŸ“Œ Slug Ã© somente para loja pÃºblica, nunca para painel.

ğŸ§© TAREFA 3 â€” LOJA PÃšBLICA CONFIGURÃVEL PELO CLIENTE

Manter a estrutura /loja/:slug, mas permitir customizaÃ§Ã£o sem cÃ³digo.

Implementar:

Tabela de configuraÃ§Ã£o por empresa (catalog_config / site_settings)

O cliente pode:

ativar/desativar seÃ§Ãµes:

banner principal

lanÃ§amentos

categorias

destaques

editar textos:

tÃ­tulo principal

subtÃ­tulo

mensagens promocionais

Frontend da loja pÃºblica:

renderiza apenas seÃ§Ãµes ativas

layout prÃ©-definido (nÃ£o permitir quebrar UI)

sem lÃ³gica hardcoded

âš ï¸ NÃ£o criar editor visual complexo.
Apenas configuraÃ§Ã£o estruturada.

ğŸ§© TAREFA 4 â€” PAINEL SUPER_ADMIN (GLOBAL)

Criar um painel exclusivo para administrador do sistema.

Deve permitir:

listar todas as empresas

status da empresa (ativa / inativa)

tipo (varejo / atacado)

mÃ©tricas bÃ¡sicas:

pedidos

faturamento

produtos ativos

acessar empresas em modo leitura (sem misturar contextos)

ğŸ“Œ SUPER_ADMIN:

nÃ£o tem company_id fixo

enxerga tudo

nÃ£o pode operar como cliente sem troca explÃ­cita de contexto

ğŸ§© TAREFA 5 â€” REMOÃ‡ÃƒO TOTAL DE DEPENDÃŠNCIAS DO REPLIT (OBRIGATÃ“RIO)

Antes de finalizar:

Remover:

qualquer uso de:

REPLIT_*

plugins especÃ­ficos do Replit

lÃ³gica de filesystem dependente do Replit

Garantir:

.env padrÃ£o

process.env no backend

import.meta.env no frontend

npm run build funcionando localmente

ğŸ“Œ O projeto deve rodar idÃªntico em:

npm run dev

npm run build

Vercel

ğŸ§© TAREFA 6 â€” VALIDAÃ‡ÃƒO FINAL (CHECKLIST)

Antes de marcar como concluÃ­do:

Criar 2 empresas

Criar produtos e categorias diferentes

Validar:

/loja/empresa-a

/loja/empresa-b

Garantir:

nenhum dado cruza empresas

Build local:

npm run build


Nenhum warning crÃ­tico

ğŸš« RESTRIÃ‡Ã•ES IMPORTANTES

âŒ NÃ£o quebrar funcionalidades existentes

âŒ NÃ£o mudar UX sem necessidade

âŒ NÃ£o acoplar painel Ã  loja pÃºblica

âŒ NÃ£o usar slug em APIs privadas

âœ… RESULTADO ESPERADO

Ao final:

projeto SaaS multi-tenant sÃ³lido

pronto para Vercel

escalÃ¡vel para dezenas/centenas de empresas

com vocÃª como SUPER_ADMIN central